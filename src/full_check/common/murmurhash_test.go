package common

import (
	"fmt"
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestMurmurHash(t *testing.T) {

	fmt.Printf("Test MurmurHash.\n")

	cases := []struct {
		Key   string
		Value int64
	}{
		// key/value pair are generated by java murmurhash
		{"indicator:1m:QH_DELAY_SUIC", -6654637216191022452},
		{"indicator:2m:QH_DELAY_SUIC", -7251477841074295642},
		{"indicator:3m:QH_DELAY_SUIC", 1176217938793873588},
		{"indicator:4m:QH_DELAY_SUIC", -4926366532659545545},
		{"indicator:5m:QH_DELAY_SUIC", 981643008755375481},
		{"indicator:6m:QH_DELAY_SUIC", -2383884510373310981},
		{"indicator:7m:QH_DELAY_SUIC", 5416542773194589995},
		{"indicator:8m:QH_DELAY_SUIC", -4625224066184523008},
		{"indicator:9m:QH_DELAY_SUIC", 1212785966489824449},
		{"indicator:10m:QH_DELAY_SUIC", 4389900425036925285},
		{"indicator:11m:QH_DELAY_SUIC", 5955136878123823170},
		{"indicator:12m:QH_DELAY_SUIC", 9167226268164874328},
		{"indicator:13m:QH_DELAY_SUIC", -5617947321465893819},
		{"indicator:14m:QH_DELAY_SUIC", 6433296872360558695},
		{"indicator:15m:QH_DELAY_SUIC", -2372284288069252603},
		{"indicator:16m:QH_DELAY_SUIC", 7610904991017576743},
		{"indicator:17m:QH_DELAY_SUIC", 964222366724854865},
		{"indicator:18m:QH_DELAY_SUIC", 5895806378559696258},
		{"indicator:19m:QH_DELAY_SUIC", -4937842885303657023},
		{"indicator:20m:QH_DELAY_SUIC", -4571373256643637837},
		{"indicator:21m:QH_DELAY_SUIC", -7152888337988953278},
		{"indicator:22m:QH_DELAY_SUIC", 8092633621162853896},
		{"indicator:23m:QH_DELAY_SUIC", -7452257918797538186},
		{"indicator:24m:QH_DELAY_SUIC", -8854399516215574304},
		{"indicator:25m:QH_DELAY_SUIC", 6676401200534715978},
		{"indicator:26m:QH_DELAY_SUIC", -2692978645537901060},
		{"indicator:27m:QH_DELAY_SUIC", -3683809054155237523},
		{"indicator:28m:QH_DELAY_SUIC", -5606518297151888695},
		{"indicator:29m:QH_DELAY_SUIC", -6081905528799736090},
		{"indicator:30m:QH_DELAY_SUIC", 1457011207660094758},
		{"indicator:31m:QH_DELAY_SUIC", 3865079810547774644},
		{"indicator:32m:QH_DELAY_SUIC", -641078235927927512},
		{"indicator:33m:QH_DELAY_SUIC", 7697595522470652524},
		{"indicator:34m:QH_DELAY_SUIC", -1412698114309485436},
		{"indicator:35m:QH_DELAY_SUIC", 5102128649287922516},
		{"indicator:36m:QH_DELAY_SUIC", 403707035974805721},
		{"indicator:37m:QH_DELAY_SUIC", 3317669349823189816},
		{"indicator:38m:QH_DELAY_SUIC", -4043896364827922855},
		{"indicator:39m:QH_DELAY_SUIC", -4489230068595047645},
		{"indicator:40m:QH_DELAY_SUIC", -1046261763545185755},
		{"indicator:41m:QH_DELAY_SUIC", 904872522840616190},
		{"indicator:42m:QH_DELAY_SUIC", 6658182203836538984},
		{"indicator:43m:QH_DELAY_SUIC", 4368490696424447958},
		{"indicator:44m:QH_DELAY_SUIC", -3519104045904693046},
		{"indicator:45m:QH_DELAY_SUIC", -532892845920159471},
		{"indicator:46m:QH_DELAY_SUIC", -4078178113398176568},
		{"indicator:47m:QH_DELAY_SUIC", -1882639881361383611},
		{"indicator:48m:QH_DELAY_SUIC", -3897000763236897518},
		{"indicator:49m:QH_DELAY_SUIC", -6313486651291057702},
		{"indicator:50m:QH_DELAY_SUIC", -1060635032209400920},
		{"indicator:51m:QH_DELAY_SUIC", 5314601411662887448},
		{"indicator:52m:QH_DELAY_SUIC", 7689477025830013947},
		{"indicator:53m:QH_DELAY_SUIC", -2140466373014007047},
		{"indicator:54m:QH_DELAY_SUIC", -2351948214331827828},
		{"indicator:55m:QH_DELAY_SUIC", -2527497793050598147},
		{"indicator:56m:QH_DELAY_SUIC", 8377506247470973240},
		{"indicator:57m:QH_DELAY_SUIC", -4916384635478538252},
		{"indicator:58m:QH_DELAY_SUIC", 8812835902806580638},
		{"indicator:59m:QH_DELAY_SUIC", -4880678292952258705},
		{"indicator:60m:QH_DELAY_SUIC", -1168335924356783204},
		{"indicator:61m:QH_DELAY_SUIC", -6307492425659739456},
		{"indicator:62m:QH_DELAY_SUIC", 8673181947080987035},
		{"indicator:63m:QH_DELAY_SUIC", -4011558869949273249},
		{"indicator:64m:QH_DELAY_SUIC", -9163214033183244634},
		{"indicator:65m:QH_DELAY_SUIC", 8546343070362872517},
		{"indicator:66m:QH_DELAY_SUIC", -494066771490701175},
		{"indicator:67m:QH_DELAY_SUIC", 828136053453139036},
		{"indicator:68m:QH_DELAY_SUIC", -5524107534654986895},
		{"indicator:69m:QH_DELAY_SUIC", 6858722774039331791},
		{"indicator:70m:QH_DELAY_SUIC", 2839513819043885355},
		{"indicator:71m:QH_DELAY_SUIC", 1342530326674604384},
		{"indicator:72m:QH_DELAY_SUIC", 2587190975537080182},
		{"indicator:73m:QH_DELAY_SUIC", 3987623248223690000},
		{"indicator:74m:QH_DELAY_SUIC", 4813748320559759337},
		{"indicator:75m:QH_DELAY_SUIC", 3018466144291616057},
		{"indicator:76m:QH_DELAY_SUIC", 1411522094125124034},
		{"indicator:77m:QH_DELAY_SUIC", 5009492611076550784},
		{"indicator:78m:QH_DELAY_SUIC", -9213529480128364681},
		{"indicator:79m:QH_DELAY_SUIC", 6210010780549530184},
		{"indicator:80m:QH_DELAY_SUIC", -6284707347542572193},
		{"indicator:81m:QH_DELAY_SUIC", 3554781779110973546},
		{"indicator:82m:QH_DELAY_SUIC", 9157957764996012315},
		{"indicator:83m:QH_DELAY_SUIC", 5374873337044737018},
		{"indicator:84m:QH_DELAY_SUIC", -1181610269748179151},
		{"indicator:85m:QH_DELAY_SUIC", 4452390294753342413},
		{"indicator:86m:QH_DELAY_SUIC", 3376957265963273559},
		{"indicator:87m:QH_DELAY_SUIC", -4162494164430044361},
		{"indicator:88m:QH_DELAY_SUIC", 9022733280485901343},
		{"indicator:89m:QH_DELAY_SUIC", 9176737835327574499},
		{"indicator:90m:QH_DELAY_SUIC", -4059587846722420812},
		{"indicator:91m:QH_DELAY_SUIC", 7514402207006524203},
		{"indicator:92m:QH_DELAY_SUIC", -4547270615703277124},
		{"indicator:93m:QH_DELAY_SUIC", 1330828250622040155},
		{"indicator:94m:QH_DELAY_SUIC", -7341423689277855634},
		{"indicator:95m:QH_DELAY_SUIC", 7413720163075488711},
		{"indicator:96m:QH_DELAY_SUIC", 3757329518875382432},
		{"indicator:97m:QH_DELAY_SUIC", -3959069832552427761},
		{"indicator:98m:QH_DELAY_SUIC", 853005367681862212},
		{"indicator:99m:QH_DELAY_SUIC", -74198832963308713},
		{"indicator:100m:QH_DELAY_SUIC", 7052096953946070124},		
	}

	for _, c := range cases {
		assert.Equal(t, MurmurHash(c.Key), c.Value, "should be equal")
	}
}
